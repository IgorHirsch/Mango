@using Mango.Web.Models.Cart
@model CartDTO

@if (Model.CartHeader != null && Model.CartDetails?.Count() > 0)
{
    <form method="post" asp-action="EmailCart">
        <input asp-for="CartHeader.UserId" hidden />
        <input asp-for="CartHeader.CartHeaderId" hidden />

        <div class="card border mt-4 container">
            <div class="card-header bg-dark text-light row">
                <div class="col-6">
                    <h3 class="text-success">
                        <i class="bi bi-cart"></i> Shopping Cart
                    </h3>
                </div>
                <div class="col-6 text-end">
                    <a asp-action="Index" asp-controller="Home" class="btn btn-outline-warning mt-2 btn-sm">
                        Continue Shopping
                    </a>
                </div>
            </div>

            <div class="card-body">

                <!-- Header Row (Desktop) -->
                <div class="d-none d-lg-block">
                    <div class="row text-info fw-bold border-bottom pb-2 mb-3">
                        <div class="col-lg-2"></div>
                        <div class="col-lg-5">Product Details</div>
                        <div class="col-lg-2">Price</div>
                        <div class="col-lg-2">Count</div>
                        <div class="col-lg-1"></div>
                    </div>
                </div>

                @foreach (var cartObj in Model.CartDetails)
                {
                    <div class="row align-items-center py-3 border-bottom">
                        <div class="col-4 col-md-2 text-center">
                            <img src="@cartObj.Product.ImageUrl" class="rounded img-fluid" />
                        </div>

                        <div class="col-8 col-md-5">
                            <h5>@cartObj.Product.Name</h5>
                            <div class="text-muted small">
                                @Html.Raw(cartObj.Product.Description)
                            </div>
                        </div>

                        <div class="col-6 col-md-2 mt-2 mt-md-0">
                            <span class="fw-semibold">@string.Format("{0:c}", cartObj.Product.Price)</span>
                        </div>

                        <div class="col-6 col-md-2 mt-2 mt-md-0">
                            <span class="fw-semibold">@cartObj.Count</span>
                        </div>

                        <div class="col-12 col-md-1 text-center mt-2 mt-md-0">
                            <a asp-action="Remove" asp-route-cartDetailsId="@cartObj.CartDetailsId" class="btn btn-sm btn-danger">
                                <i class="bi bi-trash-fill"></i>
                            </a>
                        </div>
                    </div>
                }

                <div class="row mt-4">
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-semibold">Coupon Code</label>
                        <div class="input-group">
                            <input name="couponCode" class="form-control" placeholder="Enter coupon code..." />
                            <button type="submit" class="btn btn-success">Apply</button>
                        </div>
                    </div>

                    <div class="col-md-6 text-end">
                        <div class="mb-2">
                            <span class="text-danger fw-bold fs-5">Order Total: $XX.XX</span>
                        </div>
                        <div>
                            <span class="text-success">Discount: $XX.XX</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="card-footer row">
                <div class="col-6 col-md-3 mb-2 mb-md-0">
                    <button type="submit" class="btn btn-outline-danger w-100">Email Cart</button>
                </div>
                <div class="col-6 col-md-3 offset-md-6">
                    <button disabled class="btn btn-success w-100">
                        Checkout (Coming Soon!)
                    </button>
                </div>
            </div>
        </div>
    </form>
}
else
{
    <div class="alert alert-info mt-4">
        <p>Your cart is currently empty. <a asp-action="Index" asp-controller="Home">Continue shopping</a> to add items.</p>
    </div>
}
